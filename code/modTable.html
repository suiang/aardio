<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
	<title>ä</title>
	<link rel="icon" href="../favicon.ico">
	<script type="text/javascript" src="../js/prism.js"></script>
	<link type="text/css" rel="stylesheet" href="../css/prism-monokai.css" />
</head>
<body class="language-aardio line-numbers">
<pre><code>// ${name: modTable}
// ${title: ä¿®æ”¹è¡¨è°ƒç”¨}

import console;
 
/*
Javascript Array å¯ä»¥ç›´æŽ¥è°ƒç”¨æ–¹æ³• eg:[1,2,3].map(...)
table æ¯æ¬¡éƒ½è¦  table.map(t, ...), é‚£ä¹ˆå¦‚ä½•æ‰èƒ½åƒjsä¸€æ ·é€šè¿‡ t.map(...)è°ƒç”¨å‘¢?

å…ƒè¡¨(metatable)å…è®¸æˆ‘ä»¬æ”¹å˜è¡¨(table)çš„è¡Œä¸º, å¯ä»¥é€šè¿‡ t@ = {_get = table}
ç»™è¡¨ t æŒ‡å®šåŽŸè¡¨ä¸º tableåº“, è¿™æ ·å°±å¯ä»¥é€šè¿‡ t.map(t,...) è°ƒç”¨äº†ã€‚
å¯æ˜¯è¿™é‡Œæ¯æ¬¡éƒ½è¿˜è¦è¾“å…¥ t å‚æ•°æ„Ÿè§‰æ€ªæ€ªçš„ 2333,  
ä¸‹é¢é€šè¿‡ table.map ç»™ tableåº“å‡½æ•°ç»‘å®š owner å‚æ•°å°±å¯ä»¥äº†ï¼

æ³¨æ„ï¼š
è¿™é‡Œåªæ˜¯ç»‘å®šäº†ç¬¬ä¸€å‚æ•°æ˜¯è¡¨çš„å‡½æ•°ï¼Œ
å¯¹äºŽtableåº“å…¶ä»–ç¬¬ä¸€å‚æ•°ä¸æ˜¯è¡¨è‡ªèº«çš„å‡½æ•°ä¸èµ·ä½œç”¨ã€‚
*/

meta = function(t, add = true){
	t@ = add ? {
		_get = table.map(table, function(v){
			return lambda(...) v(owner,...)
		});
		_float = true; //å…è®¸ç§»é™¤å…ƒè¡¨	
	} : null
	return t; 
}

var t = {1,2,3,4,5}

// æ·»åŠ å…ƒè¡¨
t = meta(t); 

// æµ‹è¯•ä»£ç 
console.varDump( t.filter( lambda(v) v>2 ) ) 
console.varDump( t.find(3) )
console.varDump( t.map( math.sqrt ) )
console.varDump( t.pop() )

// ç§»é™¤å…ƒè¡¨
t = meta(t,false)
console.pause(true);

// https://suiang.cn/aardio/code/modTable.html
</code></pre>
</body>
</html>
